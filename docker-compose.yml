version: '3.8'

services:
  # R + Python 分析环境
  analysis-env:
    build:
      context: ./docker
      dockerfile: Dockerfile
    container_name: bioclaw-analysis
    ports:
      - "8787:8787"  # RStudio Server
      - "8888:8888"  # JupyterLab
    volumes:
      - ./data:/home/rstudio/data
      - ./outputs:/home/rstudio/outputs
      - ./skills:/home/rstudio/skills
    environment:
      - PASSWORD=aipoch
      - ROOT=TRUE
    restart: unless-stopped
    networks:
      - bioclaw-network

  # Opencode 服务 (可选 - 也可本地运行)
  # opencode:
  #   image: node:22-alpine
  #   container_name: bioclaw-opencode
  #   ports:
  #     - "4096:4096"
  #   volumes:
  #     - .:/workspace
  #     - ~/.opencode:/root/.opencode
  #   working_dir: /workspace
  #   command: npx opencode serve --port 4096 --host 0.0.0.0
  #   environment:
  #     - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
  #   networks:
  #     - bioclaw-network

networks:
  bioclaw-network:
    driver: bridge
